---
import { languages } from "../i18n/ui";
import { useTranslations } from "../utils/i18n";
const { lang = "en" } = Astro.props;
const t = useTranslations(lang);
const currentLangName =
    languages[lang as keyof typeof languages] || languages["en"];
---

<header id="main-header">
    <nav class="nav-container">
        <a href={`/${lang === "en" ? "" : lang}`} class="logo">
            <i class="fab fa-tiktok"></i> SaveTikFast
        </a>

        <!-- Language Selector (Simple Dropdown or Link) -->
        <div class="lang-select" tabindex="0">
            {currentLangName || "English"}
            <div class="dropdown-options">
                {
                    Object.entries(languages).map(([code, name]) => (
                        <a
                            href={code === "en" ? "/" : `/${code}`}
                            class="option-item"
                        >
                            {name}
                        </a>
                    ))
                }
            </div>
        </div>
    </nav>
</header>

<nav class="nav-menu" aria-label="Download Types">
    <a
        href={`/${lang === "en" ? "" : lang}`}
        class="active"
        title={t("meta.title") || "Download TikTok Videos"}
    >
        <i class="fas fa-video"></i>
        <span>{t("nav_menu.video") || "Video"}</span>
    </a>
    <a
        href={`/${lang === "en" ? "mp3" : lang + "/mp3"}`}
        title={t("mp3_page.meta_title") || "Download TikTok Audio MP3"}
    >
        <i class="fas fa-music"></i>
        <span>{t("nav_menu.mp3") || "MP3 Audio"}</span>
    </a>
    <a
        href={`/${lang === "en" ? "story" : lang + "/story"}`}
        title={t("story_page.meta_title") || "Download TikTok Stories"}
    >
        <i class="fas fa-images"></i>
        <span>{t("nav_menu.stories") || "Stories"}</span>
    </a>
</nav>

<script>
    // Simple Language Dropdown Logic
    const langSelect = document.querySelector(".lang-select");
    if (langSelect) {
        langSelect.addEventListener("click", () => {
            const options = langSelect.querySelector(".dropdown-options");
            if (options) options.classList.toggle("show");
        });
    }
</script>

<style>
    /* Add specific styles if not in global.css yet */
    .dropdown-options.show {
        display: block;
    }
</style>
