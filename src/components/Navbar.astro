---
import { languages } from "../i18n/ui";
import { useTranslations } from "../utils/i18n";
const { lang = "en" } = Astro.props;
const t = useTranslations(lang);
const currentLangName =
    languages[lang as keyof typeof languages] || languages["en"];
---

<header id="main-header">
    <nav class="nav-container">
        <a href={`/${lang === "en" ? "" : lang}`} class="logo">
            <i class="fab fa-tiktok"></i> SaveTikFast
        </a>

        <!-- Language Selector (Simple Dropdown or Link) -->
        <div class="lang-select" tabindex="0">
            {currentLangName || "English"}
            <div class="dropdown-options">
                {
                    Object.entries(languages).map(([code, name]) => (
                        <a
                            href={code === "en" ? "/" : `/${code}`}
                            class="option-item"
                        >
                            {name}
                        </a>
                    ))
                }
            </div>
        </div>
    </nav>
</header>

<nav class="nav-menu" aria-label="Download Types">
    <a
        href={`/${lang === "en" ? "" : lang}`}
        class="active"
        title={t("hero.title")}
    >
        <i class="fas fa-video"></i>
        <span>{t("nav_menu.video")}</span>
    </a>
    <a
        href={`/${lang === "en" ? "mp3" : lang + "/mp3"}`}
        title={t("mp3_page.meta_title")}
    >
        <i class="fas fa-music"></i>
        <span>{t("nav_menu.mp3")}</span>
    </a>
    <a
        href={`/${lang === "en" ? "story" : lang + "/story"}`}
        title={t("story_page.meta_title")}
    >
        <i class="fas fa-images"></i>
        <span>{t("nav_menu.stories")}</span>
    </a>
</nav>

<script>
    // Simple Language Dropdown Logic
    const langSelect = document.querySelector(".lang-select");
    const dropdownOptions = document.querySelector(".dropdown-options");

    if (langSelect && dropdownOptions) {
        langSelect.addEventListener("click", (e) => {
            e.stopPropagation();
            dropdownOptions.classList.toggle("show");
        });

        // Close when clicking outside
        document.addEventListener("click", (e) => {
            const target = e.target as HTMLElement;
            if (!langSelect.contains(target)) {
                dropdownOptions.classList.remove("show");
            }
        });
    }
</script>

<style>
    /* Add specific styles if not in global.css yet */
    .dropdown-options.show {
        display: block;
    }
</style>
