---
interface Props {
    t: (key: string) => any;
    items?: { question: string; answer: string }[];
}

const { t, items } = Astro.props;
---

<section class="container faq-section">
    <h2 class="section-title">
        <i class="fas fa-question-circle"></i>
        {t("faq.title")}
    </h2>
    <div class="faq-container">
        {
            items && items.length > 0
                ? items.map((item) => (
                      <div class="faq-item">
                          <div class="faq-question">
                              {item.question} <i class="fas fa-chevron-down" />
                          </div>
                          <div class="faq-answer">
                              <p>{item.answer}</p>
                          </div>
                      </div>
                  ))
                : [1, 2, 3, 4, 5, 6].map((i) => (
                      <div class="faq-item">
                          <div class="faq-question">
                              {t(`faq.q${i}`)} <i class="fas fa-chevron-down" />
                          </div>
                          <div class="faq-answer">
                              <p>{t(`faq.a${i}`)}</p>
                          </div>
                      </div>
                  ))
        }
    </div>
</section>

<script>
    // FAQ Logic - Logic for Accordion
    function initFAQ() {
        const faqItems = document.querySelectorAll(".faq-item");

        faqItems.forEach((item) => {
            const question = item.querySelector(".faq-question");

            // Remove old listeners to prevent stacking if function re-runs
            const newQuestion = question?.cloneNode(true);
            if (question && newQuestion) {
                question.parentNode?.replaceChild(newQuestion, question);

                newQuestion.addEventListener("click", () => {
                    const isActive = item.classList.contains("active");

                    // Option: Close others? user didn't strictly ask, but it's standard.
                    // Let's keep "close others" for cleaner UI.
                    faqItems.forEach((other) => {
                        if (other !== item) other.classList.remove("active");
                    });

                    // Toggle current
                    item.classList.toggle("active");
                });
            }
        });
    }

    // Run immediately
    initFAQ();

    // Run on View Transitions
    document.addEventListener("astro:after-swap", initFAQ);
    document.addEventListener("astro:page-load", initFAQ);
</script>
