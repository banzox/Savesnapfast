---
import Layout from "../../layouts/Layout.astro";
import Downloader from "../../components/Downloader.jsx";
import { ui, defaultLang, languages } from "../../i18n/ui";

export async function getStaticPaths() {
    return Object.keys(languages)
        .filter((lang) => lang !== defaultLang)
        .map((lang) => ({
            params: { lang },
        }));
}

const { lang } = Astro.params;
const currentLang = lang || defaultLang;

// Helper for nested keys
const t = (key: string) => {
    let val: any = ui[currentLang] || ui[defaultLang];
    const parts = key.split(".");
    for (const part of parts) {
        if (val === undefined || val === null) break;
        val = val[part];
    }

    // Fallback to default
    if (val === undefined) {
        val = ui[defaultLang];
        for (const part of parts) {
            if (val === undefined || val === null) break;
            val = val[part];
        }
    }

    return val || key;
};
---

<Layout
    title={t("nav.privacy")}
    description={t("pages.privacy.content")?.substring(0, 150)}
    lang={currentLang}
>
    <article class="hero-section">
        <h1>{t("nav.privacy")}</h1>
        <p>{t("pages.privacy.content")?.substring(0, 150)}...</p>
        <Downloader client:load t={t} />
    </article>

    <div class="container" style="padding: 2rem;">
        <article
            class="content-box"
            style="background: var(--glass); padding: 3rem; border-radius: 25px; border: 1px solid var(--border);"
        >
            <div style="white-space: pre-line; line-height: 1.8; opacity: 0.9;">
                {t("pages.privacy.content")}
            </div>
        </article>
    </div>
</Layout>
